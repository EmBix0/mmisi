<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Island Saga 2026 | Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- 1. DESIGN-VARIABLEN --- */
        :root {
            --viking-dark: #1a1c1e;
            --viking-gold: #c5a059;
            --viking-snow: #ecf0f1;
            --viking-card-bg: rgba(30, 39, 46, 0.95);
        }

        /* --- 2. BASIS-LAYOUT --- */
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--viking-dark);
            color: var(--viking-snow);
            margin: 0;
            background-image: url('https://images.unsplash.com/photo-1513786704796-b35842f0dca6?auto=format&fit=crop&w=1920&q=80');
            background-attachment: fixed;
            background-size: cover;
        }

        header {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                        url('https://images.unsplash.com/photo-1476610182048-b716b8518aae?auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-bottom: 3px solid var(--viking-gold);
        }

        h1 { font-family: 'Cinzel', serif; font-size: clamp(2rem, 8vw, 4rem); margin: 0; letter-spacing: 5px; }

        /* --- 3. CONTAINER-SYSTEM (Gitter-Layout) --- */
        .container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 2.5fr 1fr; /* Hauptinhalt links, Sidebar rechts */
            gap: 30px;
        }

        .card {
            background: var(--viking-card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(197, 160, 89, 0.3);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            margin-bottom: 25px;
        }

        h2 { font-family: 'Cinzel', serif; color: var(--viking-gold); border-bottom: 1px solid rgba(197, 160, 89, 0.2); padding-bottom: 10px; }

        /* --- 4. BUDGET & BUTTONS --- */
        .budget-input {
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--viking-gold);
            color: var(--viking-gold);
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            width: 80px;
            text-align: right;
            outline: none;
        }

        .viking-button {
            background: transparent;
            color: var(--viking-gold);
            border: 2px solid var(--viking-gold);
            padding: 12px 30px;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 15px;
        }

        .viking-button:hover { background: var(--viking-gold); color: black; box-shadow: 0 0 15px var(--viking-gold); }

        /* --- 5. LISTEN --- */
        .list-item { display: flex; align-items: center; margin: 12px 0; }
        .list-item input { margin-right: 15px; accent-color: var(--viking-gold); width: 18px; height: 18px; }
        .done { text-decoration: line-through; opacity: 0.5; }

        /* --- 6. KARTE --- */
        .map-wrapper { position: relative; border: 2px solid var(--viking-gold); border-radius: 8px; overflow: hidden; }
        .map-image { width: 100%; display: block; filter: sepia(0.2); }
        .map-pin { position: absolute; width: 16px; height: 16px; background: var(--viking-gold); border: 2px solid white; border-radius: 50%; cursor: pointer; box-shadow: 0 0 10px var(--viking-gold); }

        /* Handy-Ansicht Optimierung */
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<header>
    <h1>ISLAND SAGA 2026</h1>
    <p>Ein digitales Pergament f√ºr Maren & Maximilian</p>
</header>

<div class="container">
    <div class="main-content">
        <div class="card">
            <h2>üêé Unsere Route</h2>
            <div class="map-wrapper">
                <img src="https://images.adacreisen.de/s9o56S3X_bChriwi-KXiO25N4Hs=/911x390/adac-freshms-prod.fra1.digitaloceanspaces.com%2Fquickstart%2Fadacreisen%2Fratgeber%2Fisland%2Frundreise-island%2F030_02_Island_Rundreise_Karte_V2.jpg" class="map-image">
                <div class="map-pin" style="top: 68%; left: 35.5%;" title="Reykjav√≠k"></div>
                <div class="map-pin" style="top: 83%; left: 48.7%;" title="V√≠k"></div>
                <div class="map-pin" style="top: 30%; left: 52.5%;" title="Akureyri"></div>
            </div>
        </div>

        <div class="card" style="text-align: center;">
            <h2>üí∞ Reise-Schatzkammer</h2>
            <table style="width:100%; text-align: left;">
                <tr><td>Mietwagen & Sprit</td><td style="text-align:right;"><input type="number" class="budget-input" id="car" value="2500" oninput="calcBudget()"> ‚Ç¨</td></tr>
                <tr><td>Fl√ºge</td><td style="text-align:right;"><input type="number" class="budget-input" id="flights" value="800" oninput="calcBudget()"> ‚Ç¨</td></tr>
                <tr><td>Unterk√ºnfte</td><td style="text-align:right;"><input type="number" class="budget-input" id="stay" value="3200" oninput="calcBudget()"> ‚Ç¨</td></tr>
                <tr><td>Verpflegung</td><td style="text-align:right;"><input type="number" class="budget-input" id="food" value="1000" oninput="calcBudget()"> ‚Ç¨</td></tr>
                <tr><td>Abenteuer</td><td style="text-align:right;"><input type="number" class="budget-input" id="tours" value="500" oninput="calcBudget()"> ‚Ç¨</td></tr>
                <tr style="border-top: 2px solid var(--viking-gold); height: 50px;">
                    <td><strong>GESAMT</strong></td>
                    <td style="text-align:right; color: var(--viking-gold); font-size: 1.3rem;"><strong id="totalPrice">8000</strong> ‚Ç¨</td>
                </tr>
            </table>
            
            <button onclick="syncToCloud()" id="syncBtn" class="viking-button">‚ö° In Cloud speichern</button>
            <p id="syncStatus" style="font-size: 0.8rem; margin-top: 10px;"></p>
        </div>
    </div>

    <div class="sidebar">
        <div class="card">
            <h2>üìú To-Do</h2>
            <div class="list-item"><input type="checkbox"> Islandpferde kontaktieren</div>
            <div class="list-item"><input type="checkbox"> Blue Lagoon buchen</div>
            <div class="list-item"><input type="checkbox"> 4x4 Mietwagen reservieren</div>
            <div class="list-item"><input type="checkbox"> Nordlicht-App laden</div>
        </div>

        <div class="card">
            <h2>üëú Packliste</h2>
            <div class="list-item"><input type="checkbox"> Regenjacke</div>
            <div class="list-item"><input type="checkbox"> Wandersocken</div>
            <div class="list-item"><input type="checkbox"> Badesachen</div>
            <div class="list-item"><input type="checkbox"> Fernglas</div>
        </div>
    </div>
</div>

<script>
    // --- KONFIGURATION ---
    const SHEET_URL = 'https://api.sheetbest.com/sheets/2df9e650-e493-4a91-8198-01c5f534da4e';

    // 1. BUDGET BERECHNEN
    function calcBudget() {
        const ids = ['car', 'flights', 'stay', 'food', 'tours'];
        let total = 0;
        ids.forEach(id => {
            const val = parseFloat(document.getElementById(id).value) || 0;
            total += val;
            localStorage.setItem('budget-' + id, val); // Lokal im Browser merken
        });
        document.getElementById('totalPrice').innerText = total.toLocaleString('de-DE');
    }

    // 2. CHECKBOXEN INITIALISIEREN
    function initCheckboxes() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((cb, index) => {
            // Stand aus Browser laden
            const saved = localStorage.getItem('todo-' + index);
            if (saved === 'true') { cb.checked = true; cb.parentElement.classList.add('done'); }
            
            // Bei Klick speichern & durchstreichen
            cb.addEventListener('change', function() {
                localStorage.setItem('todo-' + index, this.checked);
                this.parentElement.classList.toggle('done', this.checked);
            });
        });
    }

    // 3. DATEN ZUM GOOGLE SHEET SENDEN
    async function syncToCloud() {
        const btn = document.getElementById('syncBtn');
        const status = document.getElementById('syncStatus');
        btn.innerText = "Speichere Saga...";
        
        // Alle Daten in ein Objekt packen
        const dataObj = {
            car: document.getElementById('car').value,
            flights: document.getElementById('flights').value,
            stay: document.getElementById('stay').value,
            food: document.getElementById('food').value,
            tours: document.getElementById('tours').value,
            timestamp: new Date().toLocaleString()
        };

        // Status jeder Checkbox hinzuf√ºgen
        document.querySelectorAll('input[type="checkbox"]').forEach((cb, i) => {
            dataObj['todo_' + i] = cb.checked ? "JA" : "NEIN";
        });

        try {
            const response = await fetch(SHEET_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify([dataObj]),
            });
            if (response.ok) {
                status.innerText = "‚úÖ In Walhall gesichert (Google Sheet)!";
                btn.innerText = "‚ö° In Cloud speichern";
            }
        } catch (e) {
            status.innerText = "‚ùå Fehler bei der √úbertragung.";
            btn.innerText = "Erneut versuchen";
        }
    }

    // 4. DATEN AUS DER CLOUD LADEN (beim √ñffnen)
    async function loadFromCloud() {
        try {
            const response = await fetch(SHEET_URL);
            const data = await response.json();
            if (data && data.length > 0) {
                const last = data[data.length - 1]; // Letzte Zeile nehmen
                
                // Budget-Zahlen setzen
                ['car', 'flights', 'stay', 'food', 'tours'].forEach(id => {
                    if(last[id]) document.getElementById(id).value = last[id];
                });

                // Checkboxen setzen
                document.querySelectorAll('input[type="checkbox"]').forEach((cb, i) => {
                    if(last['todo_'+i]) {
                        cb.checked = last['todo_'+i] === "JA";
                        cb.parentElement.classList.toggle('done', cb.checked);
                    }
                });
                calcBudget(); // Summe neu berechnen
            }
        } catch (e) { console.log("Cloud-Laden √ºbersprungen."); }
    }

    // --- START-SEQUENZ ---
    window.onload = () => {
        initCheckboxes();
        calcBudget();
        loadFromCloud(); // Versuchen, Cloud-Daten zu holen
    };
</script>

</body>
</html>